<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Username Tool</title>
    <style>
        body {
            font-family: Consolas, monospace;
            background-color: #0c0c0c;
            color: #ffffff;
            padding: 20px;
        }
        #output {
            white-space: pre;
            background-color: #0c0c0c;
            padding: 10px;
            margin-bottom: 10px;
            height: 300px;
            overflow-y: auto;
            border: 1px solid #333;
        }
        input, button {
            font-family: Consolas, monospace;
            margin: 5px 0;
            background-color: #1e1e1e;
            color: #ffffff;
            border: 1px solid #333;
        }
        .green { color: #00ff00; }
        .red { color: #ff0000; }
        .cyan { color: #00ffff; }
    </style>
</head>
<body>
    <div id="output"></div>
    <input type="text" id="input" placeholder="Enter command..." onkeypress="handleKeyPress(event)" />

    <script>
        const outputDiv = document.getElementById('output');
        const inputField = document.getElementById('input');
        let showTakenUsernames = true;
        let generationFilter = 1;
        let generatedUsernamesCount = 0;

        document.addEventListener('DOMContentLoaded', () => {
            showMainMenu();
        });

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                executeCommand(inputField.value.trim());
                inputField.value = '';
            }
        }

        async function executeCommand(command) {
            if (command === '1') {
                showWatermark();
                await handleGeneration();
            } else if (command === '2') {
                await usernameChecker();
            } else if (command === '3') {
                showSettingsMenu();
            } else if (command === '4') {
                window.close();
            } else {
                printToOutput('Unknown command.');
            }
        }

        function showWatermark() {
            printToOutput(`
    ░█████╗░██████╗░░█████╗░░██╗░░░░░░░██╗░██████╗░██╗░░██╗██╗░░██╗
    ██╔══██╗██╔══██╗██╔══██╗░██║░░██╗░░██║██╔═══██╗╚██╗██╔╝╚██╗██╔╝
    ██║░░╚═╝██████╔╝███████║░╚██╗████╗██╔╝██║██╗██║░╚███╔╝░░╚███╔╝░
    ██║░░██╗██╔══██╗██╔══██║░░████╔═████║░╚██████╔╝░██╔██╗░░██╔██╗░
    ╚█████╔╝██║░░██║██║░░██║░░╚██╔╝░╚██╔╝░░╚═██╔═╝░██╔╝╚██╗██╔╝╚██╗
    ░╚════╝░╚═╝░░╚═╝╚═╝░░╚═╝░░░╚═╝░░░╚═╝░░░░░╚═╝░░░╚═╝░░╚═╝╚═╝░░╚═╝
          
                        RBLX-Username v1.1 Beta
            `);
        }

        async function handleGeneration() {
            printToOutput('Enter how many usernames you want to generate (or press Enter to return):');
            inputField.focus();

            const number = await getNumberInput();
            if (number !== null) {
                clearOutput();
                printToOutput(`Generating ${number} usernames...`);
                for (let i = 0; i < number; i++) {
                    let username = generateUsernameByFilter();
                    if (!showTakenUsernames) {
                        let isTaken = await checkUsernameStatus(username);
                        if (isTaken) {
                            printToOutput(`${username} - Account exists (taken), regenerating...`);
                            username = generateUsernameByFilter();
                        }
                    }
                    printToOutput(`Generated: ${username}`);
                    generatedUsernamesCount++;
                }
                printToOutput('Press Enter to Return to generation page');
            }
        }

        function generateUsernameByFilter() {
            switch (generationFilter) {
                case 1:
                    return generateRandomUsername(5);
                case 2:
                    return generate6LetterUsername();
                case 3:
                    return generate5SymbolsWith3Same();
                case 4:
                    return generate6SymbolsWith3Or4Same();
                case 5:
                    return generateThinName();
                default:
                    return generateRandomUsername(5);
            }
        }

        async function getNumberInput() {
            return new Promise((resolve) => {
                const handleInput = (event) => {
                    if (event.key === 'Enter') {
                        const value = parseInt(inputField.value.trim());
                        if (!isNaN(value) && value > 0) {
                            resolve(value);
                        } else {
                            resolve(null);
                        }
                        inputField.removeEventListener('keypress', handleInput);
                    }
                };
                inputField.addEventListener('keypress', handleInput);
            });
        }

        async function usernameChecker() {
            printToOutput('Enter a username to check (or press Enter to return):');
            inputField.focus();

            const username = await getTextInput();
            if (username !== null) {
                clearOutput();
                const status = await checkUsernameStatus(username);
                if (status === 'banned') {
                    printToOutput(`${username} - Account is banned`, 'red');
                } else if (status === true) {
                    printToOutput(`${username} - Account exists (taken)`, 'red');
                } else if (status === false) {
                    printToOutput(`${username} - Account does not exist (available)`, 'green');
                } else if (status === 2) {
                    printToOutput(`${username} - Username is inappropriate for Roblox`, 'red');
                } else if (status === 3) {
                    printToOutput(`${username} - Username must be 3 to 20 characters long.`, 'red');
                } else if (status === 4) {
                    printToOutput(`${username} - Username cannot start or end with _`, 'red');
                } else if (status === 7) {
                    printToOutput(`${username} - Only a-z, A-Z, 0-9, and _ are allowed`, 'red');
                } else {
                    printToOutput(`${username} - Unknown error`, 'red');
                }
                printToOutput('Press Enter to return to the username checker...');
            }
        }

        async function getTextInput() {
            return new Promise((resolve) => {
                const handleInput = (event) => {
                    if (event.key === 'Enter') {
                        const value = inputField.value.trim();
                        resolve(value.length > 0 ? value : null);
                        inputField.removeEventListener('keypress', handleInput);
                    }
                };
                inputField.addEventListener('keypress', handleInput);
            });
        }

        function showSettingsMenu() {
            clearOutput();
            printToOutput(`Settings Menu:
1) Toggle showing taken usernames (current: ${showTakenUsernames ? 'On' : 'Off'})
2) Filters (current: ${getFilterName()})
Select an option (or press Enter to return):`);
            inputField.focus();
        }

        function getFilterName() {
            switch (generationFilter) {
                case 1: return 'Random 5 Symbol (default)';
                case 2: return '6 Letters';
                case 3: return '5 Symbols with 3 Same Symbols';
                case 4: return '6 Symbols with 3 or 4 Same Symbols';
                case 5: return 'Thin Name';
                default: return 'Unknown';
            }
        }

        function updateSettings(command) {
            if (command === '1') {
                showTakenUsernames = !showTakenUsernames;
                printToOutput(`Show taken usernames: ${showTakenUsernames ? 'On' : 'Off'}`);
            } else if (command === '2') {
                showFilterSelection();
            } else {
                printToOutput('Invalid settings command.');
            }
        }

        function showFilterSelection() {
            clearOutput();
            printToOutput(`Select a filter:
1) Random 5 Symbol (default)
2) 6 Letters
3) 5 Symbols with 3 Same Symbols
4) 6 Symbols with 3 or 4 Same Symbols
5) Thin Name (5-6 symbols using only 't, i, l, 1, j')
Enter your choice (1-5):`);
            inputField.focus();
        }

        async function handleFilterSelection() {
            const filterChoice = await getNumberInput();
            if (filterChoice >= 1 && filterChoice <= 5) {
                generationFilter = filterChoice;
                printToOutput(`Filter set to: ${getFilterName()}`);
            } else {
                printToOutput('Invalid filter choice.');
            }
        }

        function printToOutput(text, color = 'cyan') {
            const p = document.createElement('p');
            p.textContent = text;
            p.className = color;
            outputDiv.appendChild(p);
            outputDiv.scrollTop = outputDiv.scrollHeight;
        }

        function clearOutput() {
            outputDiv.innerHTML = '';
        }
    </script>
</body>
</html>
